{"version":3,"file":"js/941.a0b0d0b5.js","mappings":"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","sources":["webpack://wooden-fish-vue-web/./src/views/ShaoXiang.vue","webpack://wooden-fish-vue-web/./src/views/ShaoXiang.vue?9523"],"sourcesContent":["<!--\n * @Author: Jackie\n * @Date: 2023-06-25 09:58:10\n * @LastEditTime: 2023-08-12 17:47:42\n * @LastEditors: Jackie\n * @Description: 烧香\n * @FilePath: /Wooden-Fish-Vue-Web/src/views/ShaoXiang.vue\n * @version: \n-->\n<template>\n  <div class=\"shaoxiang\" v-show=\"data.display\">\n    <canvas\n      id=\"container\"\n      width=\"500\"\n      height=\"500\"\n      @mousemove=\"mousepos\"\n    ></canvas>\n  </div>\n  <div class=\"note\" v-if=\"!data.display\">\n    <div class=\"f\">烧香将花费500功德，烧完可得1000功德，确定要烧香吗？</div>\n    <div class=\"button-container\">\n      <button class=\"b1\" @click=\"cal\">取消</button>\n      <button class=\"b2\" @click=\"yes\">确定</button>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport {\n  reactive,\n  computed,\n  watchEffect,\n  onMounted,\n  onBeforeUnmount\n} from 'vue';\nimport { useRouter } from 'vue-router';\nimport { useUserStore } from '@/store/user';\nconst userStore = useUserStore();\n\nconst router = useRouter();\n//context用于接受自定义事件和插槽\n//数据\nlet data = reactive({\n  center: { x: 250, y: 250 }, //画布中心点坐标\n  spiralExpanse: 8, //螺旋间距\n  pointnum: 550, //螺旋上点的数量\n  points: [],\n  animationFrame: true, //游戏运行标志，为null时结束\n\n  display: 0 //开始提示框\n});\n\n//生命周期函数，\n//onMounted：在初始化页面完成后执行\nonMounted(() => {});\n\nconst cal = () => {\n  router.push('/');\n};\n\nconst yes = () => {\n  data.display = 1;\n  userStore.setMerit(-500); //功德\n  setupSets();\n  drawLoop();\n};\n\n//初始化点螺线上的点\nconst setupSets = () => {\n  for (let i = 0; i < data.pointnum; i++) {\n    let point = {}; //x,y为点的坐标，life线段的透明度，active为点是否消失\n    let angle = 0.05 * -i;\n    point.x = data.center.x + data.spiralExpanse * angle * Math.cos(angle);\n    point.y = data.center.y + data.spiralExpanse * angle * Math.sin(angle);\n    point.active = true;\n    point.life = 1;\n\n    data.points.push(point);\n  }\n};\n\nconst draw = () => {\n  var canvas = document.getElementById('container');\n  if (!canvas.getContext) return;\n  var ctx = canvas.getContext('2d');\n  ctx.clearRect(0, 0, 500, 500); //清空所有的内容\n  ctx.lineCap = 'round';\n  ctx.moveTo(data.points[0].x, data.points[0].y);\n\n  for (let i = 1; i < data.points.length; i++) {\n    if (data.points[i].life < 1 && data.points[i].active === true) {\n      ctx.strokeStyle =\n        'rgba(244, 110, 28, ' + (0.1 + data.points[i].life) + ')';\n    } else {\n      ctx.strokeStyle =\n        'rgba(255, 255, 255, ' + (0.1 + data.points[i].life) + ')';\n    }\n    ctx.lineWidth = 6 * data.points[i].life + 4 + '';\n\n    ctx.beginPath();\n    ctx.moveTo(data.points[i - 1].x, data.points[i - 1].y);\n    ctx.lineTo(data.points[i].x, data.points[i].y);\n    ctx.stroke();\n  }\n};\n\nconst drawLoop = () => {\n  //动画更新\n  update();\n  if (data.animationFrame) {\n    draw();\n    data.animationFrame = requestAnimationFrame(drawLoop);\n  }\n};\n\nconst update = () => {\n  let foundActive = false; //所有点是否消失\n\n  for (let i = 1; i < data.points.length; i++) {\n    let dot = data.points[i];\n    let a = data.mouseX - dot.x;\n    let b = data.mouseY - dot.y;\n    let distance = Math.sqrt(a * a + b * b);\n\n    if (data.points[i].active === true) {\n      //只要还有一个点存在，则founActive为true\n      foundActive = true;\n    }\n\n    if (distance < 25 && data.points[i].active === true) {\n      //点逐渐消失\n\n      data.points[i].life = data.points[i].life - 0.04; //透明度逐渐减小，直至为零\n      if (data.points[i].life <= 0) {\n        data.points[i].active = false;\n      }\n    } else if (data.points[i].active === true && data.points[i].life < 1) {\n      data.points[i].life = data.points[i].life + 0.05; //如果点完全消失前鼠标移开了，则点逐渐变回来\n    }\n  }\n\n  if (foundActive === false) {\n    //所有点都消失后游戏结束\n    cancelAnimationFrame(data.animationFrame);\n    data.animationFrame = null;\n    endGame();\n  }\n};\n\n//退出前执行\nonBeforeUnmount(() => {\n  cancelAnimationFrame(data.animationFrame);\n  data.animationFrame = null;\n});\n\nconst mousepos = (e) => {\n  //定位鼠标位置\n  data.mouseX = e.offsetX;\n  data.mouseY = e.offsetY;\n};\n\nconst endGame = () => {\n  alert('烧香结束，恭喜获得1000点功德！');\n  userStore.setMerit(1000); //功德\n  router.push('/');\n};\n</script>\n<style lang=\"scss\" scoped>\n.shaoxiang {\n  width: 100%;\n  height: 100%;\n  position: relative;\n\n  #container {\n    position: absolute;\n    left: 50%;\n    transform: translateX(-50%);\n  }\n}\n.note {\n  background-color: #f5f5f5;\n  border: 1px solid #ddd;\n  padding: 10px;\n  border-radius: 4px;\n  margin-bottom: 10px;\n}\n\n.f {\n  font-size: 16px;\n  margin-bottom: 10px;\n}\n.button-container {\n  text-align: right;\n  .b1 {\n    background-color: #ddd;\n    color: #333;\n    padding: 5px 10px;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    margin-right: 20px;\n  }\n\n  .b2 {\n    background-color: #008dff;\n    color: #fff;\n    padding: 5px 10px;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n  }\n}\n</style>\n","import script from \"./ShaoXiang.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ShaoXiang.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ShaoXiang.vue?vue&type=style&index=0&id=715641fa&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-715641fa\"]])\n\nexport default __exports__"],"names":["userStore","useUserStore","router","useRouter","data","reactive","center","x","y","spiralExpanse","pointnum","points","animationFrame","display","onMounted","cal","push","yes","setMerit","setupSets","drawLoop","i","point","angle","Math","cos","sin","active","life","draw","canvas","document","getElementById","getContext","ctx","clearRect","lineCap","moveTo","length","strokeStyle","lineWidth","beginPath","lineTo","stroke","update","requestAnimationFrame","foundActive","dot","a","mouseX","b","mouseY","distance","sqrt","cancelAnimationFrame","endGame","onBeforeUnmount","mousepos","e","offsetX","offsetY","alert","__exports__"],"sourceRoot":""}